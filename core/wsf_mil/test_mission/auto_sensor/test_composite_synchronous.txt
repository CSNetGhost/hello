# ****************************************************************************
# CUI
#
# The Advanced Framework for Simulation, Integration, and Modeling (AFSIM)
#
# The use, dissemination or disclosure of data in this file is subject to
# limitation or restriction. See accompanying README and LICENSE for details.
# ****************************************************************************


# Requires the wsf_mil extension
test_feature wsf_mil

antenna_pattern SHIP_RADAR_FACE_ANTENNA
   circular_pattern
      beamwidth                        1 deg
      peak_gain                        40 db
      minimum_gain                     -5 db
end_antenna_pattern

sensor SHIP_RADAR_FACE WSF_RADAR_SENSOR

#   show_calibration_data
#   debug
   
   selection_mode                      multiple
   initial_mode                        SEARCH
   
   slew_mode                           azimuth_and_elevation
   azimuth_slew_limits                 -45 deg 45 deg
   elevation_slew_limits               -5 deg 85 deg
   
   mode_template
      frame_time                       10 sec
      
      transmitter
         antenna_pattern               SHIP_RADAR_FACE_ANTENNA 
         frequency                     3 ghz
         power                         500 kw
      end_transmitter
      
      receiver
         noise_power                   -150 dbw
      end_receiver

      azimuth_error_sigma              0.1 deg
      elevation_error_sigma            0.1 deg
      range_error_sigma                100 m
         
      swerling_case                    1
      
      reports_range
      reports_bearing
      reports_elevation
      reports_velocity
      #reports_state_covariance
   end_mode_template
   
   mode SEARCH
      frame_time                       10 sec
      cue_mode                         fixed
      scan_mode                        azimuth_and_elevation
      azimuth_scan_limits              -45 deg 45 deg
      elevation_scan_limits            -5 deg 85 deg
      hits_to_establish_track          2 3
      hits_to_maintain_track           1 3
      track_quality                    0.6
   end_mode
   
   mode TRACK
      frame_time                       2 sec
      scan_mode                        azimuth_and_elevation
      azimuth_scan_limits              -2 deg 2 deg
      elevation_scan_limits            -2 deg 2 deg
      maximum_request_count            1
      hits_to_establish_track          2 3
      hits_to_maintain_track           1 3
      track_quality                    1.0
   end_mode
   
#   filter WSF_KALMAN_FILTER
#   end_filter
   
end_sensor

platform_type SHIP WSF_PLATFORM
   icon Cruiser
   
   mover WSF_SURFACE_MOVER
   end_mover
   
   processor data_mgr WSF_TRACK_PROCESSOR
      purge_interval 60 sec
   end_processor
   
   processor task_mgr WSF_TASK_PROCESSOR

      script_variables
         string SENSOR_NAME     = "radar";
         string TRACK_MODE_NAME  = "TRACK";
         string SENSOR_TASK_NAME = "Track";
      end_script_variables
      
      execute at_time 12 sec absolute
         WsfTrack t = PLATFORM.MasterTrackList().Entry(0);
         StartTracking(t, SENSOR_TASK_NAME, SENSOR_NAME, TRACK_MODE_NAME, PLATFORM);
      end_execute
      
      execute at_time 23 sec absolute
         WsfTrack t = PLATFORM.MasterTrackList().Entry(0);
         StopTracking(t.TrackId(), SENSOR_TASK_NAME, SENSOR_NAME);
      end_execute
      
   end_processor
   
   sensor radar WSF_COMPOSITE_SENSOR
      operating_mode                     synchronous
      
      sensor                             face-1
      sensor                             face-2
      sensor                             face-3
      sensor                             face-4
      
      internal_link data_mgr
      ignore_same_side
   end_sensor
   
   sensor face-1 SHIP_RADAR_FACE
      yaw 45 deg
   end_sensor
   
   sensor face-2 SHIP_RADAR_FACE
      yaw 135 deg
   end_sensor
   
   sensor face-3 SHIP_RADAR_FACE
      yaw -135 deg
   end_sensor
   
   sensor face-4 SHIP_RADAR_FACE
      yaw -45 deg
   end_sensor
end_platform_type

radar_signature TARGET_RADAR_SIG
   constant 10 m^2
end_radar_signature

platform_type TARGET WSF_PLATFORM
   icon F-18E
   radar_signature TARGET_RADAR_SIG
   mover WSF_AIR_MOVER end_mover
end_platform_type

platform ship SHIP
   side blue
   position 39n 90w heading 0 deg
   
   sensor radar
      on
      ignore_same_side
   end_sensor
end_platform

platform target TARGET
   side red
   route
      position 38.5n 89w altitude 30000 ft heading 0 deg speed 500 kts
   end_route
end_platform

end_time 45 sec

/*
event_output
   file   replay.evt
   enable SENSOR_DETECTION_ATTEMPT
   enable SENSOR_DETECTION_CHANGED
   enable SENSOR_TURNED_ON
   enable SENSOR_TURNED_OFF
   enable SENSOR_MODE_ACTIVATED
   enable SENSOR_MODE_DEACTIVATED
   enable SENSOR_REQUEST_INITIATED
   enable SENSOR_REQUEST_CANCELED
   enable SENSOR_TRACK_INITIATED
   enable SENSOR_TRACK_DROPPED
   enable SENSOR_TRACK_UPDATED
   enable LOCAL_TRACK_INITIATED
   enable LOCAL_TRACK_UPDATED
   enable LOCAL_TRACK_DROPPED
   #print_track_covariance true
end_event_output

event_pipe
   file replay.aer
end_event_pipe
*/
#end_time 15 sec

