# ****************************************************************************
# CUI
#
# The Advanced Framework for Simulation, Integration, and Modeling (AFSIM)
#
# The use, dissemination or disclosure of data in this file is subject to
# limitation or restriction. See accompanying README and LICENSE for details.
# ****************************************************************************

// Performs basic input tests for mediums, and the various
// objects that utilize them in the AFSIM core.
// Warnings cannot be tested, but manual inspection of this
// test should result in three warnings for shared mediums.

///////////////////////SHARED MEDIUMS///////////////////////
# Medium types
medium TEST_MEDIUM WSF_COMM_MEDIUM_GUIDED
   channels 16
   mode default
      propagation_speed 200000000 m/s
      transfer_rate 5120 bytes/s
      packet_loss_time 0.001 s
   end_mode
   mode alternate
      propagation_speed 200000005 m/s
      transfer_rate 1024 bytes/s
      packet_loss_time 0.005 s
   end_mode
   mode just_default_settings_mode
   end_mode
   default_mode_name alternate
end_medium

medium TEST_MEDIUM_RF WSF_COMM_MEDIUM_UNGUIDED
   channels 128
   mode default
      propagation_speed 200000000 m/s
      transfer_rate 5120 bytes/s
      packet_loss_time 0.001 s
      bit_error_probability 0.000001
      bit_error_rate_ebno_table
        0.00000001 12
        0.0000001  11.3
        0.000001   10.3
        0.00001    9.5
        0.0001     8.3
        0.001      6.5
        0.01       4.3
        0.1        0
      end_bit_error_rate_ebno_table
      error_correction 0.5
   end_mode
   mode alternate
      propagation_speed 200000005 m/s
      transfer_rate 1024 bytes/s
      packet_loss_time 0.005 s
      snr_transfer_rate_table
         dB bit/s
         0  100
         1  100
         2  90
         3  80
         4  40
         5  20
         55 10
         70 1
      end_snr_transfer_rate_table
   end_mode
   mode just_default_settings_mode
   end_mode
   default_mode_name default
end_medium

medium TEST_MEDIUM_ROUTER WSF_COMM_MEDIUM_GUIDED
   channels 16
   mode default
      propagation_speed 200000000 m/s
      transfer_rate 5120 bytes/s
      packet_loss_time 0.001 s
   end_mode
   mode alternate
      propagation_speed 200000005 m/s
      transfer_rate 1024 bytes/s
      packet_loss_time 0.005 s
   end_mode
   mode just_default_settings_mode
   end_mode
   default_mode_name alternate
end_medium

medium TEST_MEDIUM_ROUTER_RF WSF_COMM_MEDIUM_UNGUIDED
   channels 128
   mode default
      propagation_speed 200000000 m/s
      transfer_rate 5120 bytes/s
      packet_loss_time 0.001 s
      bit_error_probability 0.000001
      bit_error_rate_ebno_table
        0.00000001 12
        0.0000001  11.3
        0.000001   10.3
        0.00001    9.5
        0.0001     8.3
        0.001      6.5
        0.01       4.3
        0.1        0
      end_bit_error_rate_ebno_table
      error_correction 0.5
   end_mode
   mode alternate
      propagation_speed 200000005 m/s
      transfer_rate 1024 bytes/s
      packet_loss_time 0.005 s
      snr_transfer_rate_table
         dB bit/s
         0  100
         1  100
         2  90
         3  80
         4  40
         5  20
         55 10
         70 1
      end_snr_transfer_rate_table
   end_mode
   mode just_default_settings_mode
   end_mode
   default_mode_name default
end_medium

# One of each core comm models
comm COMM_RCVR WSF_COMM_RCVR
   #add medium TEST_MEDIUM_RF end_medium #Invalid - Cannot test
   add medium TEST_MEDIUM end_medium
end_comm

comm COMM_XMTR WSF_COMM_XMTR
   #add medium TEST_MEDIUM_RF end_medium #Invalid - Cannot test
   add medium TEST_MEDIUM end_medium
end_comm

comm COMM_TRANSCEIVER WSF_COMM_TRANSCEIVER
   #add medium TEST_MEDIUM_RF end_medium #Invalid - Cannot test
   add medium TEST_MEDIUM end_medium
end_comm

comm RADIO_XMTR WSF_RADIO_XMTR
   #add medium TEST_MEDIUM end_medium #Invalid - Cannot test currently
   add medium TEST_MEDIUM_RF end_medium
   transmitter
      power 50 w
      frequency 50 mhz
   end_transmitter
end_comm

comm RADIO_RCVR WSF_RADIO_RCVR
   #add medium TEST_MEDIUM end_medium #Invalid - Cannot test currently
   add medium TEST_MEDIUM_RF end_medium
   receiver
      frequency 50 mhz
   end_receiver
end_comm

comm RADIO_TRANSCEIVER WSF_RADIO_TRANSCEIVER
   #add medium TEST_MEDIUM end_medium #Invalid - Cannot test currently
   add medium TEST_MEDIUM_RF end_medium
   transmitter
      power 50 w
      frequency 50 mhz
   end_transmitter
   receiver
      frequency 50 mhz
   end_receiver
end_comm

// Router usage with shared mediums
router ROUTER_WIRED WSF_COMM_ROUTER
   add medium TEST_MEDIUM_ROUTER end_medium
end_router

platform testRouter1 WSF_PLATFORM
   add router default ROUTER_WIRED end_router
end_platform

platform testRouter2 WSF_PLATFORM
   add router default ROUTER_WIRED 
      # warning for shared edit
      edit medium TEST_MEDIUM_ROUTER 
         transfer_rate 100 mbytes/s
      end_medium
   end_router
end_platform

router ROUTER_WIRELESS WSF_COMM_ROUTER
   add medium TEST_MEDIUM_ROUTER_RF end_medium
end_router

platform testRouter3 WSF_PLATFORM
   add router default ROUTER_WIRELESS end_router
end_platform

platform testRouter4 WSF_PLATFORM
   add router default ROUTER_WIRELESS
      # warning for shared edit
      edit medium TEST_MEDIUM_ROUTER_RF 
         transfer_rate 100 mbytes/s
         error_correction 0.2
      end_medium
   end_router
end_platform

// Platform instances
platform test1 WSF_PLATFORM
   add comm comm COMM_RCVR
   end_comm
end_platform

platform test2 WSF_PLATFORM
   add comm comm COMM_XMTR
   end_comm
end_platform

platform test3 WSF_PLATFORM
   add router default ROUTER_WIRED end_router
   add comm comm COMM_TRANSCEIVER
   end_comm
end_platform

platform test4 WSF_PLATFORM
   add comm comm RADIO_XMTR
   end_comm
end_platform

platform test5 WSF_PLATFORM
   add comm comm RADIO_RCVR
   end_comm
end_platform

platform test6 WSF_PLATFORM
   add comm comm RADIO_TRANSCEIVER
   
   #Editing a shared medium provides a warning.
   #This is proper functionality
   edit medium TEST_MEDIUM_RF
      #implied default mode edit
      transfer_rate 2048 bytes/s
      
      #If naming a mode that exists, the values
      #provided are updated. Previously, the medium used a
      #snr table. The snr table is overridden by the
      #provided values. Then a new ebno table is
      #provided, which becomes the default usage
      #for this medium and everyone else using it.
      mode alternate
         propagation_speed 200000005 m/s
         transfer_rate 1024 bytes/s
         packet_loss_time 0.005 s
         snr_transfer_rate_table
            dB bit/s
            0  101
            1  101
            2  91
            3  81
            4  41
            5  21
            55 11
            70 1
         end_snr_transfer_rate_table
         bit_error_probability 0.000001
         bit_error_rate_ebno_table
           0.00000001 12.1
           0.0000001  11.4
           0.000001   10.4
           0.00001    9.5
           0.0001     8.4
           0.001      6.5
           0.01       4.4
           0.1        0
         end_bit_error_rate_ebno_table
         error_correction 0.5
      end_mode
      
      #If naming a non-existent mode, that mode is
      #created with default values, and updated with
      #those provided by the user at this time.
      mode edit_add_mode
         propagation_speed 200000005 m/s
         transfer_rate 1024 bytes/s
         packet_loss_time 0.005 s
         snr_transfer_rate_table
            dB bit/s
            0  102
            1  102
            2  92
            3  82
            4  42
            5  22
            55 12
            70 2
         end_snr_transfer_rate_table
         bit_error_probability 0.000001
         bit_error_rate_ebno_table
           0.00000001 12.2
           0.0000001  11.5
           0.000001   10.5
           0.00001    9.6
           0.0001     8.5
           0.001      6.6
           0.01       4.5
           0.1        0
         end_bit_error_rate_ebno_table
         error_correction 0.4      
      end_mode     
   end_medium
   end_comm
end_platform

// Legacy input bypass
platform test7 WSF_PLATFORM
   add comm comm WSF_COMM_TRANSCEIVER
      propagation_speed 200000000 m/s
      transfer_rate 5120 bytes/s
      packet_loss_time 0.001 s
   end_comm
end_platform

platform test8 WSF_PLATFORM
   add comm comm WSF_RADIO_TRANSCEIVER
      transmitter
         power 50 w
         frequency 50 mhz
      end_transmitter
      receiver
         frequency 50 mhz
      end_receiver
      
      propagation_speed 200000005 m/s
      transfer_rate 1024 bytes/s
      packet_loss_time 0.005 s
      
      bit_error_probability 0.000001
      bit_error_rate_ebno_table
        0.00000001 12
        0.0000001  11.3
        0.000001   10.3
        0.00001    9.5
        0.0001     8.3
        0.001      6.5
        0.01       4.3
        0.1        0
      end_bit_error_rate_ebno_table
      error_correction 0.5
      
      snr_transfer_rate_table
         dB bit/s
         0  100
         1  100
         2  90
         3  80
         4  40
         5  20
         55 10
         70 1
      end_snr_transfer_rate_table
   end_comm
end_platform

///////////////////////NON-SHARED MEDIUMS///////////////////////
medium TEST_MEDIUM_UNIQUE WSF_COMM_MEDIUM_GUIDED
   channels 16
   mode default
      propagation_speed 200000000 m/s
      transfer_rate 5120 bytes/s
      packet_loss_time 0.001 s
   end_mode
   mode alternate
      propagation_speed 200000005 m/s
      transfer_rate 1024 bytes/s
      packet_loss_time 0.005 s
   end_mode
   mode just_default_settings_mode
   end_mode
   default_mode_name alternate
   use_sharing false
end_medium

medium TEST_MEDIUM_RF_UNIQUE WSF_COMM_MEDIUM_UNGUIDED
   channels 128
   mode default
      propagation_speed 200000000 m/s
      transfer_rate 5120 bytes/s
      packet_loss_time 0.001 s
      bit_error_probability 0.000001
      bit_error_rate_ebno_table
        0.00000001 12
        0.0000001  11.3
        0.000001   10.3
        0.00001    9.5
        0.0001     8.3
        0.001      6.5
        0.01       4.3
        0.1        0
      end_bit_error_rate_ebno_table
      error_correction 0.5
   end_mode
   mode alternate
      propagation_speed 200000005 m/s
      transfer_rate 1024 bytes/s
      packet_loss_time 0.005 s
      snr_transfer_rate_table
         dB bit/s
         0  100
         1  100
         2  90
         3  80
         4  40
         5  20
         55 10
         70 1
      end_snr_transfer_rate_table
   end_mode
   mode just_default_settings_mode
   end_mode
   default_mode_name default
   use_sharing false
end_medium

medium TEST_MEDIUM_ROUTER_UNIQUE WSF_COMM_MEDIUM_GUIDED
   channels 16
   mode default
      propagation_speed 200000000 m/s
      transfer_rate 5120 bytes/s
      packet_loss_time 0.001 s
   end_mode
   mode alternate
      propagation_speed 200000005 m/s
      transfer_rate 1024 bytes/s
      packet_loss_time 0.005 s
   end_mode
   mode just_default_settings_mode
   end_mode
   default_mode_name alternate
   use_sharing false
end_medium

medium TEST_MEDIUM_ROUTER_RF_UNIQUE WSF_COMM_MEDIUM_UNGUIDED
   channels 128
   mode default
      propagation_speed 200000000 m/s
      transfer_rate 5120 bytes/s
      packet_loss_time 0.001 s
      bit_error_probability 0.000001
      bit_error_rate_ebno_table
        0.00000001 12
        0.0000001  11.3
        0.000001   10.3
        0.00001    9.5
        0.0001     8.3
        0.001      6.5
        0.01       4.3
        0.1        0
      end_bit_error_rate_ebno_table
      error_correction 0.5
   end_mode
   mode alternate
      propagation_speed 200000005 m/s
      transfer_rate 1024 bytes/s
      packet_loss_time 0.005 s
      snr_transfer_rate_table
         dB bit/s
         0  100
         1  100
         2  90
         3  80
         4  40
         5  20
         55 10
         70 1
      end_snr_transfer_rate_table
   end_mode
   mode just_default_settings_mode
   end_mode
   default_mode_name default
   use_sharing false
end_medium

# One of each core comm models
comm COMM_RCVR_UNIQUE WSF_COMM_RCVR
   #add medium TEST_MEDIUM_RF end_medium #Invalid - Cannot test
   add medium TEST_MEDIUM_UNIQUE end_medium
end_comm

comm COMM_XMTR_UNIQUE WSF_COMM_XMTR
   #add medium TEST_MEDIUM_RF end_medium #Invalid - Cannot test
   add medium TEST_MEDIUM_UNIQUE end_medium
end_comm

comm COMM_TRANSCEIVER_UNIQUE WSF_COMM_TRANSCEIVER
   #add medium TEST_MEDIUM_RF end_medium #Invalid - Cannot test
   add medium TEST_MEDIUM_UNIQUE end_medium
end_comm

comm RADIO_XMTR_UNIQUE WSF_RADIO_XMTR
   #add medium TEST_MEDIUM end_medium #Invalid - Cannot test currently
   add medium TEST_MEDIUM_RF_UNIQUE end_medium
   transmitter
      power 50 w
      frequency 50 mhz
   end_transmitter
end_comm

comm RADIO_RCVR_UNIQUE WSF_RADIO_RCVR
   #add medium TEST_MEDIUM end_medium #Invalid - Cannot test currently
   add medium TEST_MEDIUM_RF_UNIQUE end_medium
   receiver
      frequency 50 mhz
   end_receiver
end_comm

comm RADIO_TRANSCEIVER_UNIQUE WSF_RADIO_TRANSCEIVER
   #add medium TEST_MEDIUM end_medium #Invalid - Cannot test currently
   add medium TEST_MEDIUM_RF_UNIQUE end_medium
   transmitter
      power 50 w
      frequency 50 mhz
   end_transmitter
   receiver
      frequency 50 mhz
   end_receiver
end_comm

// Router usage with shared mediums
router ROUTER_WIRED_UNIQUE WSF_COMM_ROUTER
   add medium TEST_MEDIUM_ROUTER_UNIQUE end_medium
end_router

platform testRouterUnique1 WSF_PLATFORM
   add router default ROUTER_WIRED_UNIQUE end_router
end_platform

platform testRouterUnique2 WSF_PLATFORM
   add router default ROUTER_WIRED_UNIQUE 
      # NO WARNING - NOT SHARED
      edit medium TEST_MEDIUM_ROUTER_UNIQUE 
         transfer_rate 100 mbytes/s
      end_medium
   end_router
end_platform

router ROUTER_WIRELESS_UNIQUE WSF_COMM_ROUTER
   add medium TEST_MEDIUM_ROUTER_RF_UNIQUE end_medium
end_router

platform testRouterUnique3 WSF_PLATFORM
   add router default ROUTER_WIRELESS_UNIQUE end_router
end_platform

platform testRouterUnique4 WSF_PLATFORM
   add router default ROUTER_WIRELESS_UNIQUE
      # NO WARNING - NOT SHARED
      edit medium TEST_MEDIUM_ROUTER_RF_UNIQUE
         transfer_rate 100 mbytes/s
         error_correction 0.2
      end_medium
   end_router
end_platform

// Platform instances
platform testUnique1 WSF_PLATFORM
   add comm comm COMM_RCVR_UNIQUE
   end_comm
end_platform

platform testUnique2 WSF_PLATFORM
   add comm comm COMM_XMTR_UNIQUE
   end_comm
end_platform

platform testUnique3 WSF_PLATFORM
   add router default ROUTER_WIRED_UNIQUE end_router
   add comm comm COMM_TRANSCEIVER_UNIQUE
   end_comm
end_platform

platform testUnique4 WSF_PLATFORM
   add comm comm RADIO_XMTR_UNIQUE
   end_comm
end_platform

platform testUnique5 WSF_PLATFORM
   add comm comm RADIO_RCVR_UNIQUE
   end_comm
end_platform

platform testUnique6 WSF_PLATFORM
   add comm comm RADIO_TRANSCEIVER_UNIQUE
   
   #NO WARNING
   edit medium TEST_MEDIUM_RF_UNIQUE
      #implied default mode edit
      transfer_rate 2048 bytes/s
      
      #If naming a mode that exists, the values
      #provided are updated. Previously, the medium used a
      #snr table. The snr table is overridden by the
      #provided values. Then a new ebno table is
      #provided, which becomes the default usage
      #for this medium and everyone else using it.
      mode alternate
         propagation_speed 200000005 m/s
         transfer_rate 1024 bytes/s
         packet_loss_time 0.005 s
         snr_transfer_rate_table
            dB bit/s
            0  101
            1  101
            2  91
            3  81
            4  41
            5  21
            55 11
            70 1
         end_snr_transfer_rate_table
         bit_error_probability 0.000001
         bit_error_rate_ebno_table
           0.00000001 12.1
           0.0000001  11.4
           0.000001   10.4
           0.00001    9.5
           0.0001     8.4
           0.001      6.5
           0.01       4.4
           0.1        0
         end_bit_error_rate_ebno_table
         error_correction 0.5
      end_mode
      
      #If naming a non-existent mode, that mode is
      #created with default values, and updated with
      #those provided by the user at this time.
      mode edit_add_mode
         propagation_speed 200000005 m/s
         transfer_rate 1024 bytes/s
         packet_loss_time 0.005 s
         snr_transfer_rate_table
            dB bit/s
            0  102
            1  102
            2  92
            3  82
            4  42
            5  22
            55 12
            70 2
         end_snr_transfer_rate_table
         bit_error_probability 0.000001
         bit_error_rate_ebno_table
           0.00000001 12.2
           0.0000001  11.5
           0.000001   10.5
           0.00001    9.6
           0.0001     8.5
           0.001      6.6
           0.01       4.5
           0.1        0
         end_bit_error_rate_ebno_table
         error_correction 0.4      
      end_mode     
   end_medium
   end_comm
end_platform

end_time 1 s