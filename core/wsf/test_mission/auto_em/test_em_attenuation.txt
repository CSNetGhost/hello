# ****************************************************************************
# CUI
#
# The Advanced Framework for Simulation, Integration, and Modeling (AFSIM)
#
# The use, dissemination or disclosure of data in this file is subject to
# limitation or restriction. See accompanying README and LICENSE for details.
# ****************************************************************************

//! Tests the base functionality of the script WsfEM_Attenuation object.

attenuation_model TEST_ATTENUATION simple
end_attenuation_model

antenna_pattern RADAR_ANTENNA
  rectangular_pattern
     peak_gain           35 dB
     minimum_gain       -20 dB
     azimuth_beamwidth   5 deg
     elevation_beamwidth 45 deg
  end_rectangular_pattern
end_antenna_pattern

sensor TEST_RADAR WSF_RADAR_SENSOR
   // These values are generated solely for testing and
   // are not based on any analog
   frame_time 5.0 sec
   reports_side

   transmitter
      attenuation TEST_ATTENUATION
      duty_cycle 0.5
      frequency             2.0 ghz
      alternate_frequency 1 2.1 ghz
      alternate_frequency 2 2.2 ghz
      antenna_pattern_table
         polarization default
            frequency 2.0 ghz RADAR_ANTENNA
            frequency 2.1 ghz RADAR_ANTENNA
            frequency 2.2 ghz RADAR_ANTENNA
      end_antenna_pattern_table
      powers
         frequency 2.0 ghz 75000 watts
         frequency 2.1 ghz 70000 watts
         frequency 2.2 ghz 55000 watts
      end_powers
      pulse_width 50 usec
      pulse_repetition_frequencies
         prf 1 500 hz
         prf 2 350 hz
      end_pulse_repetition_frequencies
      internal_loss              2 db
      pulse_compression_ratio    13 absolute
   end_transmitter
   
   receiver 
      frequency 2.0 ghz
      beam_tilt 1.2 deg
      bandwidth 20000 hz
      instantaneous_bandwidth 10000 hz
      internal_loss 1.1 db
      antenna_pattern_table
         polarization default
            frequency 2.0 ghz RADAR_ANTENNA
            frequency 2.1 ghz RADAR_ANTENNA
            frequency 2.2 ghz RADAR_ANTENNA
         polarization horizontal
            frequency 2.0 ghz RADAR_ANTENNA
            frequency 2.1 ghz RADAR_ANTENNA
            frequency 2.2 ghz RADAR_ANTENNA
         polarization vertical
            frequency 2.0 ghz RADAR_ANTENNA
            frequency 2.1 ghz RADAR_ANTENNA
            frequency 2.2 ghz RADAR_ANTENNA
      end_antenna_pattern_table
   end_receiver
end_sensor

platform_type TEST_PLATFORM WSF_PLATFORM
   sensor sensor TEST_RADAR
   end_sensor
end_platform_type

platform test_radar TEST_PLATFORM
end_platform

execute at_time 1.0 s absolute
   WsfPlatform platform = WsfSimulation.FindPlatform("test_radar");
   WsfSensor sensor = platform.Sensor("sensor");
   WsfEM_Xmtr xmtr = sensor.Xmtr(0);
   
   WsfEM_Attenuation attenuation = xmtr.AttenuationModel();
   if(!attenuation.IsValid())
   {
      writeln("-FAIL-");
      writeln("Fail attenuation validity check.");
   }
        
   string attType = attenuation.Type();
   if(attType != "TEST_ATTENUATION")
   {
      writeln("-FAIL-");
      writeln("Fail attenuation type check.");   
   }
end_execute
