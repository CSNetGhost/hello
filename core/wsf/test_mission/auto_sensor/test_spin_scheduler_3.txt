# ****************************************************************************
# CUI
#
# The Advanced Framework for Simulation, Integration, and Modeling (AFSIM)
#
# The use, dissemination or disclosure of data in this file is subject to
# limitation or restriction. See accompanying README and LICENSE for details.
# ****************************************************************************

# EZJA test case 3
# Two targets enter sensor volume from outside, 180 degrees apart

include_once ../auto_script/test_functions.txt
include_once spin_scheduler_resources.txt

end_time 3 min
observer 
   enable SENSOR_DETECTION_ATTEMPT 
end_observer

execute at_time .01 sec absolute 
   WsfSimulation.FindPlatform("sam_1").DeletePlatform();
end_execute

script_variables 
   double last_detection_time = 0;
end_script_variables

script void SensorDetectionAttempt(WsfPlatform aPlatform, WsfSensor aSensor, WsfPlatform aTarget, WsfSensorInteraction aResult) 
   if (last_detection_time == 0)
   {
      last_detection_time = TIME_NOW;
   }
   else 
   {
      AssertTrueMessage(Math.Fabs(TIME_NOW - last_detection_time) - 5 < 1, "Time between detections not spaced correctly");
      last_detection_time = TIME_NOW;
   }
end_script

platform bomber_case_3_1 BOMBER 
   position 30:35n 80:00w
   
   side red
   altitude 30000 feet
   heading 270 degrees

   route
      position 30:35:00.000n 80:00:00.000w altitude 25000.00 ft
         speed 500 mph
      position 30:34:09.453n 81:33:20.250w altitude 25000.00 ft
   end_route

end_platform
platform bomber_case_3_2 BOMBER 
   position 30:35n 83:00w
   
   side red
   altitude 30000 feet
   heading 270 degrees

   route
      position 30:35:00.000n 83:00:00.000w altitude 25000.00 ft
         speed 500 mph
      position 30:35:45.655n 81:26:05.046w altitude 25000.00 ft
   end_route
end_platform
