# ****************************************************************************
# CUI
#
# The Advanced Framework for Simulation, Integration, and Modeling (AFSIM)
#
# The use, dissemination or disclosure of data in this file is subject to
# limitation or restriction. See accompanying README and LICENSE for details.
# ****************************************************************************

platform test_platform WSF_PLATFORM

   icon satellite
   add mover WSF_SPACE_MOVER
      position 0n 0w altitude 500 km heading 0 deg
      mission_sequence
         maneuver tangent
            execute_at eclipse_entry
            delta_v 0.000000000001 m/s
         end_maneuver 
         maneuver tangent
            execute_at eclipse_exit
            delta_v -0.00000000001 m/s
         end_maneuver 
      end_mission_sequence      
   end_mover
   
#   execute at_interval_of 30 seconds
#      WsfSpaceMover mover = (WsfSpaceMover)PLATFORM.Mover();
#      WsfDraw draw = {};
#      draw.Erase(1);
#      draw.SetId(1);
#      draw.BeginLines();
#      draw.Vertex(PLATFORM);
#      Vec3 sunLoc = Sun.UnitVecWCS(WsfDateTime.CurrentTime());
#      sunLoc.Scale(1.0e11);
#      draw.VertexWCS(sunLoc);
#      draw.End();      
#   end_execute   
   
end_platform

script_variables
   double sSMA = 0.0;
   double sSMA1 = 35800000;
   double sSMA2 = 30000000;
   int sNumCompleted = 0;
end_script_variables

script void OrbitalManeuverInitiated(WsfPlatform        aPlatform,
                                     WsfSpaceMover      aSM,
                                     WsfOrbitalManeuver aManeuver)
   if (sNumCompleted == 0)
   {
      if ((TIME_NOW < 2115.9) || (TIME_NOW > 2116.0))
      {
         if (TIME_NOW > 0.0)
         {
            writeln("-FAIL-", TIME_NOW);
         }
      }
   }
   else if ((TIME_NOW < 4256.0) || (TIME_NOW > 4257.0)) 
   {
      writeln("-FAIL-", 2);
   }
end_script

script void OrbitalManeuverCompleted(WsfPlatform        aPlatform,
                                     WsfSpaceMover      aSM,
                                     WsfOrbitalManeuver aManeuver)
   sNumCompleted += 1;
end_script

script void SimulationComplete()
   if (sNumCompleted != 2)
   {
      writeln("-FAIL- ", sNumCompleted);
   }
end_script

observer   
   enable ORBITAL_MANEUVER_INITIATED OrbitalManeuverInitiated 
   enable ORBITAL_MANEUVER_COMPLETED OrbitalManeuverCompleted 
   enable SIMULATION_COMPLETE
end_observer 

#event_pipe
#   file test_eclipse_event_constraint.aer
#end_event_pipe
#
#event_output
#   file test_eclipse_event_constraint.evt
#   enable ORBITAL_MANEUVER_INITIATED
#   enable ORBITAL_MANEUVER_COMPLETED
#end_event_output

end_time 3 hours
