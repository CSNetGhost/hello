# ****************************************************************************
# CUI
#
# The Advanced Framework for Simulation, Integration, and Modeling (AFSIM)
#
# The use, dissemination or disclosure of data in this file is subject to
# limitation or restriction. See accompanying README and LICENSE for details.
# ****************************************************************************

include_once utils.txt

end_time 2 s

script_variables
   # These values come from Vallado, Fundamentals of Astrodynamics and Application, Fourth Edition,
   # Table 8-4, page 567.
   double gAltA = 0.0;
   double gRhoA = 1.225;
   
   double gAltB = 70000.0;
   double gRhoB = 8.770e-5;
   
   double gAltC = 400000.0;
   double gRhoC = 3.725e-12;
   
   double gRelativeError = 1.0e-4;
end_script_variables

execute at_time 1 s absolute
   WsfPiecewiseExponentialAtmosphere atmo = WsfPiecewiseExponentialAtmosphere.Construct();
   
   ExpectString(atmo.ModelType(), "WSF_PIECEWISE_EXPONENTIAL_ATMOSPHERE", "Model type");
   
   WsfGeoPoint pt = WsfGeoPoint.Construct(10.0, 30.0, gAltA);
   Calendar now = WsfDateTime.CurrentTime();
   ExpectNearRelative(atmo.Density(now, pt), gRhoA, gRhoA * gRelativeError, "Density A");

   pt = WsfGeoPoint.Construct(-20.0, -50.0, gAltB);
   ExpectNearRelative(atmo.Density(now, pt), gRhoB, gRhoB * gRelativeError, "Density B");
   
   pt = WsfGeoPoint.Construct(50.0, 0.0, gAltC);
   ExpectNearRelative(atmo.Density(now, pt), gRhoC, gRhoC * gRelativeError, "Density C");
end_execute
